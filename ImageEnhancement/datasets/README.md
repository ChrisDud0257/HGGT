# Training and Inference Dataset Preparation

## Training dataset
We utilize the widely-used DF2K_OST dataset, which is composed of [DIV2K(1-800 images for training)](https://data.vision.ee.ethz.ch/cvl/DIV2K/), [Flickr2K](https://cv.snu.ac.kr/research/EDSR/Flickr2K.tar) and [OST](https://github.com/xinntao/SFTGAN) dataset.

- Firstly, please download them through the link on the above.
- Secondly, Merge all of the HR images into a file.
- Then, extract sub images, please modify ```'input_folder'``` to your DF2K_OST dataset directory. Modify ```'save_folder'``` to your save folder. And execute:
```bash
cd ImageEnhancement/scripts/data_preparation
python extract_subimages.py
```
- Last, generate meta info, please modify ```--input```, ```--root``` and ```--meta_info```. And execute:
```bash
cd ImageEnhancement/scripts/data_preparation
python generate_meta_info.py
```

When you train the enhancement models, you shold modify the ```datasets[dataroot_gt]``` and ```datasets[meta_info]``` parameters in the ```./ImageEnhancement/options/train/EnhancementModels/*.yml``` file.


## Validation dataset
During your training progress, you could use any datasets to validate your enhance models. We provide the widely-used Set5 dataset in ```./ImageEnhancement/datasets/```. Note that, there is no GT here since the existing Set5 dataset is just the HR image. You just need to observe whether the validation results have better perception quality than the existing HR images.

## Inference dataset
The inference dataset is used to provide source images for the well-trained enhance models. After you generate the enhanced HR images through the enhance models, you could utilize them to go through the patch selection and data annotation progress. 
We collect HR images from three different resources, 800 images from the existing DIV2K, 400 images from online(Unsplash or Pixabay) which could be used for free, and 400 images taken by our mobile phones from the real-world scene.
- [DIV2K(1-800 images for training)](https://data.vision.ee.ethz.ch/cvl/DIV2K/)
- [Unsplash](https://unsplash.com/) and [Pixabay](https://pixabay.com/)
- Taken by mobile phones

We name the collected 1600 images as ```MultiGT1600```, and you could download the original HR images from [GoogleDrive](https://drive.google.com/drive/folders/1YDVKhsJW7efyFZVjCO3nDn51WMVsTI7z?usp=sharing).

- When generating enhanced GTs, Please modify the ```--input``` path to your download ```MultiGT1600``` path in ```./ImageEnhancement/demo.sh``` or ```./ImageEnhancement/inference/inference_*.py```.

We also provide the enhanced GTs generated by our enhance models, you could download them from [GoogleDrive](https://drive.google.com/drive/folders/1-K-kekt6vHEZgTdNCV-V7q1P_YjJuMYy?usp=sharing).